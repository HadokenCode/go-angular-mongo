"use strict";goApp.controller("ChainController",["$http","$mdEditDialog","$q","$timeout","$scope","$mdDialog","$mdMedia","ChainFactory","GlobalServices","AuthenticationFactory",ChainController]);function ChainController($http,$mdEditDialog,$q,$timeout,$scope,$mdDialog,$mdMedia,factory,globalServices,af){var ao=af.authData;var userRole="OSR Admin";if(userRole=="OSR Admin"||userRole=="OSR Sales"){}else{globalServices.youreNotAllowed()}$scope.loading=false;$scope.fd=globalServices.formatDate;$scope.fdt=globalServices.formatDateTime;$scope.options={rowSelection:true,multiSelect:false,autoSelect:true,decapitate:false,largeEditDialog:false,boundaryLinks:false,limitSelect:true,pageSelect:true};$scope.selected=[];$scope.limitOptions=[5,8,10,15,20,50,100,500,1e3];$scope.query={order:"ChainCode",limit:8,page:1};$scope.logPagination=function(page,limit){console.log("page: ",page);console.log("limit: ",limit)};$scope.columns=[{name:"ChainCode",orderBy:"ChainCode"},{descendFirst:true,name:"ChainCode",numeric:true,orderBy:"ChainCode"}];$scope.records={};$scope.randMess="";var randomLoadingMessage=function(){var lines=new Array("Eating butter coconut...","Sipping noodles...","Practicing my Kungfu while eating mamon...","Generating records...","Brewing coffee...","Please be patient while getting data from the server...");$scope.randMess=lines[Math.round(Math.random()*(lines.length-1))]};$scope.toggleLimitOptions=function(){$scope.limitOptions=$scope.limitOptions?undefined:[5,8,10,15,20,50,100,500]};$scope.onPaginate=function(page,limit){$scope.promise=$timeout(function(){},2e3)};$scope.deselect=function(item){};$scope.log=function(item){$scope.chainDetails=item};var setToGlobalRecords=function(r){$scope.records.data=[].concat(r)};var setToLastQuery=function(query){$scope.lastQuery="";$scope.lastQuery=query};var generateRecords=function(){randomLoadingMessage();$scope.loading=true;var payload={};payload.query="";setToLastQuery("")};$scope.loadStuff=function(){generateRecords()};$scope.loadStuff();$scope.onReorder=function(order){$scope.promise=$timeout(function(){},2e3)};$scope.showExportConfirm=function(ev){var confirm=$mdDialog.confirm().title("Would you like to export this to csv?").textContent("").ariaLabel("Export").targetEvent(ev).ok("Yes, please export!").cancel("Cancel");$mdDialog.show(confirm).then(function(){$scope.status="Confirmed";var mystyle={headers:true,column:{style:{Font:{Bold:"1"}}}};var sql="";sql+="SELECT";sql+=" chainCode AS Chain_Code";sql+=" , chainName AS Chain_Name";sql+=" INTO CSV('Chain_"+$scope.fdt(new Date)+".csv', {headers:true, separator:','}) FROM ?";alasql.promise(sql,[$scope.records.data]).then(function(result){if(result==1){swal("success","Your file is ready for download","success")}}).catch(function(err){swal("warning","The file is too large, an error occured!","warning")})},function(){$scope.status="Cancelled"})};var updateChain=function(payload){swal({title:"Are you sure?",text:"You are about to update the Chain Code: "+payload.chainCode+" with a Chain Name: "+payload.chainName,type:"info",showConfirmButton:true,showCancelButton:true},function(isConfirm){if(isConfirm){$scope.loading=true;factory.updateChain(payload).then(function(){$scope.selected=[];$scope.loading=false;generateRecords();swal("Saved!","Successfully updated the chain","success");$mdDialog.hide()})}})};var deleteChain=function(payload){swal({title:"Are you sure?",text:"You are about to delete the "+payload.chainCode,type:"warning",showConfirmButton:true,showCancelButton:true},function(isConfirm){if(isConfirm){$scope.loading=true;factory.deleteChain(payload).then(function(){$scope.selected=[];$scope.loading=false;generateRecords();swal("Deleted!","Successfully deleted the chain","success");$mdDialog.hide()})}})};$scope.showChainDetails=function(ev,item){function detailsController($scope,$mdDialog){if(item==undefined){$scope.modalStatus="New"}else{$scope.modalStatus="Edit"}$scope.chainDetailsList=[].concat(item);$scope.NewChainCode="";$scope.NewChainName="";$scope.updateChain=function(){var payload={};if(item==undefined){payload.chainCode=$scope.NewChainCode;$scope.modalStatus="New"}else{payload.chainCode=item.chainCode}payload.chainName=$scope.NewChainName;updateChain(payload)};$scope.deleteChain=function(){var payload={};payload.id=item.id;payload.chainCode=item.chainCode;deleteChain(payload)};$scope.hide=function(){$mdDialog.hide()};$scope.cancel=function(){$mdDialog.cancel()}}$mdDialog.show({controllerAs:"odc",controller:["$scope","$mdDialog",detailsController],templateUrl:"public/html/chain/view/detail.html",parent:angular.element(document.body),targetEvent:ev,clickOutsideToClose:true}).then(function(answer){},function(){})};$scope.showMoreOptions=function(ev){$mdDialog.show({controllerAs:"odc",controller:["$scope","$mdDialog",moreOptionsController],templateUrl:"public/html/chain/view/search.html",parent:angular.element(document.body),targetEvent:ev,clickOutsideToClose:true}).then(function(answer){},function(){});function moreOptionsController($scope,$mdDialog){$scope.records={};$scope.records.data=[];$scope.hide=function(){$mdDialog.hide()};$scope.cancel=function(){$mdDialog.cancel()};$scope.loading=false;$scope.nextKey=1;$scope.items={0:{field:"C.ChainCode LIKE '%",keyword:"",dateFrom:"",dateTo:"",condition:"",value:"Chain Code contains "}};$scope.remove=function(idx){delete $scope.items[idx]};$scope.delete=function(idx){var person_to_delete=$scope.persons[idx];API.DeletePerson({id:person_to_delete.id},function(success){$scope.persons.splice(idx,1)})};$scope.add=function(){$scope.items[$scope.nextKey]={field:"",keyword:"",dateFrom:"",dateTo:"",condition:" AND ",value:"",type:"String"};$scope.nextKey+=1;$scope.endClause=true};var resetQuery=function(){$scope.items={};$scope.items={0:{field:"C.ChainCode LIKE '%",keyword:"",dateFrom:"",dateTo:"",condition:"",value:"PO No contains ",type:"String"}}};$scope.newQuery=function(){};$scope.resetQuery=function(){resetQuery()};$scope.condition=[{text:" AND ",value:"AND"},{text:" OR ",value:"OR"}];$scope.conditionIfDate=[{text:" AND ",value:"AND"},{text:" OR ",value:"OR"}];$scope.fields=[{text:"C.ChainCode LIKE '%",value:"ChainCode",type:"String"},{text:"C.ChainName LIKE '%",value:"ChainName",type:"String"}];$scope.endClause=true;$scope.changedCondition=function(item){if(item.condition!=="%' "){$scope.endClause=false}else{$scope.endClause=true}};$scope.changedField=function(item){switch(item.field){case"C.ChainCode LIKE '%":item.value="ChainCode contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"C.ChainName LIKE '%":item.value="ChainName contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;default:item.value=""}};$scope.loadStuff=function(){randomLoadingMessage();$scope.loading=true;var payload={};var toString=[];var lastQuery=[];payload.query="";payload.topRow="2000";angular.forEach($scope.items,function(o){if(o.field==undefined||o.field==""){return false}if(o.dateFrom!==""){var dateF=moment(o.dateFrom);var dateT=moment(o.dateTo);if(dateF>=dateT){swal("Warning","Please provide a valid date range!","warning");return false}var currentKeyword="'"+globalServices.formatDate(o.dateFrom)+"'"+" AND "+"'"+globalServices.formatDate(o.dateTo)+"'";o.keyword=currentKeyword;toString.push(o.condition+" ");toString.push(o.field);toString.push(o.keyword);lastQuery.push(o.condition+" ");lastQuery.push(o.value);lastQuery.push(o.keyword)}else{toString.push(o.condition);toString.push(o.field);toString.push(o.keyword);toString.push("%' ");lastQuery.push(o.condition);lastQuery.push(o.value);lastQuery.push(" '"+o.keyword+"' ")}return false});payload.query=toString.join("");$scope.lastQuery=lastQuery.join("");factory.getRecords(payload).then(function(r){setToGlobalRecords(r);$mdDialog.hide();$scope.loading=false;setToLastQuery($scope.lastQuery)},function(){console.log(payload.query);swal("Warning","An error encountered, please check your query combination.")})}}}}"use strict";goApp.factory("ChainFactory",["$http","$q","APIService",function($http,$q,apiService){const urlApi=apiService.urlAPI;const f={};var u=urlApi+"/api/Chain";var config={headers:{"Content-Type":"application/json; charset=utf-8"}};f.getRecords=function(payload){const d=$q.defer();$http.post(u,payload,config).success(d.resolve).error(d.reject);return d.promise};f.updateChain=function(payload){const d=$q.defer();$http.post(u+"/update",payload,config).success(d.resolve).error(d.reject);return d.promise};f.deleteChain=function(payload){const d=$q.defer();$http.post(u+"/delete",payload,config).success(d.resolve).error(d.reject);return d.promise};return f}]);"use strict";goApp.controller("ChatController",["$scope","ChatFactory","$timeout","$mdSidenav","$log","$window","AuthenticationFactory",function($scope,factory,$timeout,$mdSidenav,$log,$window,authData){var primaryList=[];factory.getPrimaryImage().then(function(result){primaryList=result});var activityStreamHub=connection.createHubProxy("activityStreamHub");var sendActivityData=function(value){activityStreamHub.invoke("sendActivityData",value).done(function(){}).fail(function(){})};activityStreamHub.on("receiveActivityData",function(value){angular.forEach(value,function(o){o.color=Math.floor(Math.random()*16777215).toString(16)});$scope.activities=value});var truckerSmsHub=connection.createHubProxy("truckerSmsHub");var sendSmsData=function(value){truckerSmsHub.invoke("sendSmsData",value).done(function(){}).fail(function(){})};truckerSmsHub.on("receiveSmsData",function(value){$scope.truckerMessages=value});connection.start().done(function(){sendActivityData({});sendSmsData({})}).fail(function(){});const auth=authData.authData;$scope.userName=auth.userDetails[1];$scope.primaryPic=auth.userDetails[4];$scope.messages=[];factory.getMessage().then(function(result){angular.forEach(result,function(message){message={User:message.user,Message:message.message,DateTime:message.dateTime};angular.forEach(primaryList,function(o){if(o.userName===message.User){console.log(o.primary);message.PrimaryPic=o.primary;return}return});$scope.messages.push(message)})});$scope.chatMessage="";$scope.sendMessage=function(message){if(message==undefined||message===""){return}const chatMessage={user:$scope.userName,message:message};factory.sendMessage(chatMessage).then(function(result){sendMessage(result);$scope.chatMessage=""},function(){swal("Error sending message","","error")})};$scope.myFunct=function(keyEvent){if(keyEvent.which===13)$scope.sendMessage($scope.chatMessage)};$scope.close=function(){$mdSidenav("right").close().then(function(){$log.debug("close RIGHT is done")})}}]);"use strict";goApp.factory("ChatFactory",["$http","$q","APIService",function($http,$q,apiService){const urlApi=apiService.urlAPI;const f={};var u=urlApi+"/api/Chat";var config={headers:{"Content-Type":"application/json; charset=utf-8"}};f.sendMessage=function(message){const d=$q.defer();$http.post(u,message,config).success(d.resolve).error(d.reject);return d.promise};f.getMessage=function(){const d=$q.defer();$http.get(u,config).success(d.resolve).error(d.reject);return d.promise};f.getPrimaryImage=function(){const d=$q.defer();$http.get(u+"/primary",config).success(d.resolve).error(d.reject);return d.promise};return f}]);"use strict";goApp.controller("DashboardController",["$scope","DashboardService","GlobalServices","$timeout","$q","$log","AuthenticationFactory",DashboardController]);function DashboardController($scope,service,globalServices,$timeout,$q,$log,af){var ao=af.authData;var userRole=ao.userRoles[0].itemArray[1];console.log(ao);var hasAllParams=false;if(userRole=="OSR Admin"||userRole=="OSR Sales"){hasAllParams=true}else{globalServices.youreNotAllowed()}$scope.loading=true;$scope.loadingResources=true;var exportObj=[];var connection=$.hubConnection();var dashboardHub=connection.createHubProxy("DashboardHub");dashboardHub.on("receivedashboardvalue",function(){});var sendDashboardValue=function(){dashboardHub.invoke("sendDashboardValue").done(function(){}).fail(function(){})};connection.start().done(function(){sendDashboardValue()}).fail(function(){});$scope.payload={};$scope.areas=[];$scope.chains=[];$scope.warehouses=[];$scope.weekToDates=[];$scope.reportDataTypes=[{name:"Po Count",value:0},{name:"Total Quantity",value:1}];function getParams(payload){service.getParameters(payload).then(function(result){console.log(result);$scope.areas=result.area;$scope.chains=result.chain;$scope.warehouses=result.warehouse;$scope.weekToDates=result.weekToDate;if(userRole=="OSR Admin"){$scope.areas.unshift({areaName:"All"});$scope.chains.unshift({chainCode:"All",chainName:"All"});$scope.warehouses.unshift({sLocName:"All"})}$scope.payload={area:$scope.areas[0].areaName,chain:$scope.chains[0].chainCode,warehouse:$scope.warehouses[0].sLocName,weekToDate:JSON.stringify($scope.weekToDates[0]),reportData:$scope.reportDataTypes[0].value};$scope.filter($scope.payload);$scope.loadingResources=false})}getParams({userId:ao.userDetails[0]});$scope.filter=function(payload){var currentPayload={area:payload.area==="All"?null:payload.area,chain:payload.chain==="All"?null:payload.chain,warehouse:payload.warehouse==="All"?null:payload.warehouse,weekToDate:JSON.parse(payload.weekToDate),reportData:payload.reportData};$scope.fday=globalServices.formatDate(currentPayload.weekToDate.dateFrom);$scope.lday=globalServices.formatDate(currentPayload.weekToDate.dateTo);$scope.getPieChart(currentPayload);$scope.getBarChart(currentPayload)};$scope.colorScheme=[];$scope.getPieChart=function(payload){service.getPieChart(payload).then(function(value){$scope.totalCounts=0;exportObj=value;angular.forEach(value,function(o){delete o.$$hashKey;$scope.totalCounts+=o.y;if(o.key==="CSS - For Processing"){o.color="#FFD740"}else if(o.key==="CSS - New PO"){o.color="#FFD740"}else if(o.key==="Invoiced - Delivered to Customer"){o.color="#2CA02C"}else if(o.key==="Invoiced - In Transit"){o.color="#2CA02C"}else if(o.key==="Sales - Cancelled/Error"){o.color="#FFD740"}else if(o.key==="Sales - Hold/For Approval"){o.color="#FFD740"}else if(o.key==="Warehouse - For Consolidation"){o.color="#FF5722"}else if(o.key==="Warehouse - For Loading"){o.color="#FF5722"}else if(o.key==="Warehouse - Loadplan"){o.color="#FF5722"}else if(o.key==="Warehouse - Picking"){o.color="#FF5722"}else{o.color="#dddddd"}});$scope.pieData=value})};$scope.xFunction=function(){return function(d){return d.key}};$scope.yFunction=function(){return function(d){return d.y}};$scope.descriptionFunction=function(){return function(d){return d.key}};$scope.showExportConfirm=function(){globalServices.exportExcel(exportObj,"PieData")};function CreateTableChart(res){angular.forEach(res,function(o){var total=0;total+=o.monday;total+=o.tuesday;total+=o.wednesday;total+=o.thursday;total+=o.friday;total+=o.saturday;total+=o.sunday;if(o.monday==null)o.Percentmonday=0;if(o.tuesday==null)o.Percenttuesday=0;if(o.wednesday==null)o.Percentwednesday=0;if(o.thursday==null)o.Percentthursday=0;if(o.friday==null)o.Percentfriday=0;if(o.saturday==null)o.Percentsaturday=0;if(o.sunday==null)o.Percentsunday=0;if(o.monday!==0)o.Percentmonday=(o.monday/total*100).toFixed(2);if(o.tuesday!==0)o.Percenttuesday=(o.tuesday/total*100).toFixed(2);if(o.wednesday!==0)o.Percentwednesday=(o.wednesday/total*100).toFixed(2);if(o.thursday!==0)o.Percentthursday=(o.thursday/total*100).toFixed(2);if(o.friday!==0)o.Percentfriday=(o.friday/total*100).toFixed(2);if(o.saturday!==0)o.Percentsaturday=(o.saturday/total*100).toFixed(2);if(o.sunday!==0)o.Percentsunday=(o.sunday/total*100).toFixed(2)});var totalObj={groupName:"Total",Percentmonday:100,Percenttuesday:100,Percentwednesday:100,Percentthursday:100,Percentfriday:100,Percentsaturday:100,Percentsunday:100};res.push(totalObj);$scope.tableData=[].concat(res)}$scope.onReorder=function(order){};var exportBarChart={};$scope.getBarChart=function(payload){$scope.loading=true;service.getBarChart(payload).then(function(res){exportBarChart=res;$scope.multipleBarChartData=[];angular.forEach(res,function(o){$scope.multipleBarChartData.push({key:o.groupName,values:[{x:"Monday",y:o.monday},{x:"Tuesday",y:o.tuesday},{x:"Wednesday",y:o.wednesday},{x:"Thursday",y:o.thursday},{x:"Friday",y:o.friday},{x:"Saturday",y:o.saturday},{x:"Sunday",y:o.sunday}]})});$scope.barChartData=[];angular.forEach(res,function(o){$scope.barChartData.push({key:o.groupName,values:[["Monday",o.monday],["Tuesday",o.tuesday],["Wednesday",o.wednesday],["Thursday",o.thursday],["Friday",o.friday],["Saturday",o.saturday],["Sunday",o.sunday]]})});CreateTableChart(res);$scope.loading=false})};$scope.showExportBarChart=function(){globalServices.exportExcel(exportBarChart,"MultipleBarChartData")};$scope.showExportTableChart=function(){globalServices.exportExcel($scope.tableData,"TableChartData")};function changeColor(){var elms=document.getElementsByTagName("rect");Array.prototype.forEach.call(elms,function(elm){var clr=elm.style.fill||"";clr=clr.replace(/\s/g,"").toLowerCase();if(clr=="rgb(31,119,180)"||clr=="rgb(174,199,232)"){angular.element(elm).addClass("bar-css")}else{}})}var colorArray=["#FFEB3B","#FFEB3B","#FFEB3B","#FFEB3B","#4CAF50","#4CAF50","#FF5722","#FF5722","#FF5722","#FF5722"];$scope.options={chart:{type:"multiBarChart",color:function(d,i){return colorArray[i]},height:550,margin:{top:30,right:20,bottom:45,left:100},padding:{top:20},clipEdge:true,duration:500,stacked:true,xAxis:{showMaxMin:false},yAxis:{axisLabel:"Y Axis",axisLabelDistance:-20,tickFormat:function(d){return d3.format(",.1f")(d)}},legend:{dispatch:{legendClick:function(e){},legendDblclick:function(e){},legendMouseover:function(e){},legendMouseout:function(e){},stateChange:function(e){$scope.colorScheme=[].concat(e.disabled)}}}}};$scope.options2={chart:{showLegend:false,type:"multiBarChart",color:function(d,i){return colorArray[i]},height:550,margin:{top:30,right:20,bottom:45,left:100},padding:{top:20},clipEdge:true,duration:500,stacked:true,xAxis:{showMaxMin:false},yAxis:{axisLabel:"Y Axis",axisLabelDistance:-20,tickFormat:function(d){return d3.format(",.1f")(d)}},legend:{dispatch:{legendClick:function(e){},legendDblclick:function(e){},legendMouseover:function(e){},legendMouseout:function(e){},stateChange:function(e){$scope.disabledItems=e}}}}}}"use strict";goApp.factory("DashboardService",["$http","$q","APIService",function($http,$q,apiService){const urlApi=apiService.urlAPI;const f={};var u=urlApi+"/api/dashboard";var config={headers:{"Content-Type":"application/json; charset=utf-8"}};f.getParameters=function(payload){const d=$q.defer();$http.post(u+"/parameters",payload,config).success(d.resolve).error(d.reject);return d.promise};f.getPieChart=function(payload){const d=$q.defer();$http.post(u+"/PieChart",payload,config).success(d.resolve).error(d.reject);return d.promise};f.getBarChart=function(payload){const d=$q.defer();$http.post(u+"/BarChart",payload,config).success(d.resolve).error(d.reject);return d.promise};return f}]);"use strict";goApp.controller("HomeController",["$scope","$window","AuthenticationFactory",HomeController]);function HomeController($scope,$window,af){var ao=af.authData;var userRole="OSR Admin";$scope.hasAccess=function(url){url="home";if((url=="home"||url=="chain"||url=="dashboard"||url=="loadplan"||url=="warehouse_picking"||url=="checking_consolidation"||url=="loading_trucks"||url=="po_activity"||url=="howto")&&userRole=="OSR Admin"){return true}else if((url=="dashboard"||url=="po_activity"||url=="howto")&&userRole=="OSR Sales"){return true}else if((url=="loadplan"||url=="howto")&&userRole=="OSR LoadPlan"){return true}else if((url=="warehouse_picking"||url=="howto")&&userRole=="OSR Picking"){return true}else if((url=="checking_consolidation"||url=="howto")&&userRole=="OSR Consolidation"){return true}else if((url=="loading_trucks"||url=="howto")&&userRole=="OSR Loading"){return true}else{return false}};$scope.homeList=[{name:"Dashboard",url:"dashboard",icon:"pie_chart"},{name:"Loadplan",url:"loadplan",icon:"assignment"},{name:"Picking",url:"warehouse_picking",icon:"touch_app"},{name:"Consolidation",url:"checking_consolidation",icon:"pages"},{name:"Loading to Trucks",url:"loading_trucks",icon:"airport_shuttle"},{name:"PO Activity",url:"po_activity",icon:"fitness_center"},{name:"Chain Maintenance",url:"chain",icon:"link"},{name:"Trucker SMS Logs Report",url:"report_trucker_logs",icon:"message"},{name:"How To",url:"howto",icon:"help"}];$scope.goToPage=function(url){console.log(url);$window.location.href="#/main/"+url}}"use strict";goApp.controller("HowToController",["$scope","HowToFactory","$sce","$timeout",function($scope,f,$sce,$timeout){var controller=this;controller.state=null;controller.API=null;controller.currentVideo=0;controller.onPlayerReady=function(API){controller.API=API};controller.onCompleteVideo=function(){controller.isCompleted=true;controller.currentVideo++;if(controller.currentVideo>=controller.videos.length)controller.currentVideo=0;controller.setVideo(controller.currentVideo)};controller.videos=[{sources:[{title:"How to Cancel Loadplan",description:"Cancel loadplan individual or batch",src:$sce.trustAsResourceUrl("public/video/how-to-cancel-loadplan.mp4"),type:"video/mp4"}]},{sources:[{title:"How to Reject Consolidation",description:"Reject Consolidation individual",src:$sce.trustAsResourceUrl("public/video/how-to-reject-consolidation.mp4"),type:"video/mp4"}]},{sources:[{title:"How to Reject Loading to Truck",description:"Reject Loading to Truck individual",src:$sce.trustAsResourceUrl("public/video/how-to-reject-loadingtotruck.mp4"),type:"video/mp4"}]},{sources:[{title:"How to Reject Picking",description:"Reject Warehouse Picking individual",src:$sce.trustAsResourceUrl("public/video/how-to-reject-picking.mp4"),type:"video/mp4"}]},{sources:[{title:"How to Use PO Activity",description:"Explore PO Activity",src:$sce.trustAsResourceUrl("public/video/how-to-use-po-activity.mp4"),type:"video/mp4"}]},{sources:[{title:"How Add Chain Code",description:"Adding Chain Code has never been easy.",src:$sce.trustAsResourceUrl("public/video/HowAddChainCode.mp4"),type:"video/mp4"}]},{sources:[{title:"How To Batch Cancel Loadplan",description:"Batch Cancelling Truck Allocation in Loadplan.",src:$sce.trustAsResourceUrl("public/video/HowToBatchCancelLoadplan.mp4"),type:"video/mp4"}]},{sources:[{title:"How To Confirm Loading To Truck",description:"Invidual Confirmation of Ttruck Allocation in Loading to Truck module.",src:$sce.trustAsResourceUrl("public/video/HowToConfirmLoadingToTruck.mp4"),type:"video/mp4"}]},{sources:[{title:"How To Confirm Loadplan",description:"Batch Confirmation of Ttruck Allocation in Loadplan module.",src:$sce.trustAsResourceUrl("public/video/HowToConfirmLoadplan.mp4"),type:"video/mp4"}]},{sources:[{title:"How To Consolidate TA",description:"Individual Consolidation of Ttruck Allocation in Checking & Consolidation module.",src:$sce.trustAsResourceUrl("public/video/HowToConsolidateTA.mp4"),type:"video/mp4"}]},{sources:[{title:"How To Delete Chain Code",description:"Deleting record of chain code.",src:$sce.trustAsResourceUrl("public/video/HowToDeleteChain.mp4"),type:"video/mp4"}]},{sources:[{title:"How To Edit Chain Code Information",description:"Updating record of chain code.",src:$sce.trustAsResourceUrl("public/video/HowToEditChain.mp4"),type:"video/mp4"}]},{sources:[{title:"How To Export Chain Code List",description:"Exporting Chain Code list",src:$sce.trustAsResourceUrl("public/video/HowToExportChain.mp4"),type:"video/mp4"}]},{sources:[{title:"How To Filter Chain",description:"Quick Filter Search from Chain Code list",src:$sce.trustAsResourceUrl("public/video/HowToFilterChain.mp4"),type:"video/mp4"}]},{sources:[{title:"How To Pick TA in Warehouse Picking",description:"Individual Picking Truck Allocation in Warehouse Picking module.",src:$sce.trustAsResourceUrl("public/video/HowToPickTAinWarehousePicking.mp4"),type:"video/mp4"}]},{sources:[{title:"How To Search Chain",description:"Searching Chain Code with multiple clause in Chain maintenance.",src:$sce.trustAsResourceUrl("public/video/HowToSearchChain.mp4"),type:"video/mp4"}]},{sources:[{title:"How To Use Chat",description:"Using chat feature will connect from loading to picking or from consolidation to loading to truck.",src:$sce.trustAsResourceUrl("public/video/HowToUseChat.mp4"),type:"video/mp4"}]},{sources:[{title:"How To Use Dashboard",description:"Dashboard monitoring in bar chart and pie chart.",src:$sce.trustAsResourceUrl("public/video/HowToUseDashboard.mp4"),type:"video/mp4"}]},{sources:[{title:"How To View Activty Stream",description:"Viewing Activity Stream.",src:$sce.trustAsResourceUrl("public/video/HowToViewActivtyStream.mp4"),type:"video/mp4"}]},{sources:[{title:"How To View SMS",description:"Viewing Trucker SMS.",src:$sce.trustAsResourceUrl("public/video/HowToViewSMS.mp4"),type:"video/mp4"}]}];controller.currentVideoTitle=controller.videos[0].sources[0].title;controller.config={preload:"none",autoHide:false,autoHideTime:3e3,autoPlay:false,sources:controller.videos[0].sources,theme:{url:"http://www.videogular.com/styles/themes/default/latest/videogular.css"},plugins:{poster:"public/img/videogular.png"}};controller.setVideo=function(index){console.log(index);controller.currentVideoTitle=controller.videos[index].sources[0].title;controller.API.stop();controller.currentVideo=index;controller.config.sources=controller.videos[index].sources;$timeout(controller.API.play.bind(controller.API),100)}}]);"use strict";goApp.factory("HowToFactory",["$http","$q","$sce",function($http,$q,$sce){return{getHtvList:function(){return[{title:"How to transfer css assignments to multiple customer code",tags:["transfer account","css assignment"],description:"Transfer CSS Assignments to a multiple selected customer codes with their category assignments (source warehouse)",module:"Transfer Account",config:{preload:"none",sources:[{src:$sce.trustAsResourceUrl("public/video/how-to-cancel-loadplan.mp4"),type:"video/mp4"}],plugins:{poster:"public/img/videogular.png"}}},{title:"002",tags:["customer"],description:"lorem ipsum",module:"Customer Maintenance",config:{preload:"none",sources:[{src:$sce.trustAsResourceUrl("public/video/how-to-reject-consolidation.mp4"),type:"video/mp4"}],plugins:{poster:"public/img/videogular.png"}}}]}}}]);"use strict";goApp.controller("LoginController",["$http","$scope","$state","$window","AuthenticationFactory","localStorageService","$location",function($http,$scope,$state,$window,authentication,cookie,$location){$scope.currentPath=$location.path();$scope.obj={userName:"",password:"",warehouse:""};var ipInfo="";$scope.authData=authentication.authData;var condition1=angular.isUndefined(cookie.get("uName"));$scope.userName=condition1?null:cookie.get("uName");var condition2=angular.isUndefined(cookie.get("isffs"));$scope.isFFS=condition2?false:cookie.get("isffs");cookie.set("isffs",$scope.isFFS);$scope.loading=false;$scope.animateError=false;$scope.editingItem={};$scope.currentUserItem={};$scope.foo="";$scope.warehouses=[];$scope.getUserSloc=function(userName){var payload={};payload.UserName=userName;authentication.getUserWarehouse(payload).then(function(result){if(result.length==0){swal("Warning","No available warehouse/storage location for the username "+userName,"warning");return}$scope.obj.warehouse=result[0].warehouseCodes.slice(0,-1)},function(){})};$scope.login=function(obj){$scope.loading=true;$window.location.href="#/main/home"};function onload(){$scope.editingItem={};var mainP="";cookie.set("uName",$scope.userName);switch($scope.currentUserRole){case"OSR Admin":mainP="#/main/home";break;case"OSR LoadPlan":mainP="#/main/loadplan";break;case"OSR Picking":mainP="#/main/warehouse_picking";break;case"OSR Consolidation":mainP="#/main/checking_consolidation";break;case"OSR Loading":mainP="#/main/loading_trucks";break;case"OSR Sales":mainP="#/main/dashboard";break;default:swal({title:"Login Failed",text:"You are not allowed to access this site",type:"warning",confirmButtonText:"OK",closeOnConfirm:true},function(isConfirm){if(isConfirm){authentication.logout()}});mainP="#/login"}cookie.set("isffs",$scope.isFFS);$window.location.href=mainP;$window.location.reload(true)}$scope.logout=function(e){cookie.remove("uName");cookie.remove("isffs");e.preventDefault();authentication.logout();$window.location.href="#/login"}}]);"use strict";goApp.factory("AuthenticationFactory",["$http","$q","localStorageService","APIService","$window",function($http,$q,storage,apiService){var urlAPI=apiService.urlAPI;var authenticationFactory={};var x={userDetails:undefined,userModules:[],userRoles:{},acctCustomers:"",salesCustomers:"",cssCustomers:"",message:"",warehouse:"",availableWarehouse:""};var config={headers:{"Content-Type":"application/json; charset=utf-8"}};var create=function(object){var deferred=$q.defer();var config={headers:{"Content-Type":"application/json; charset=utf-8"}};$http.post(urlAPI+"/api/UserAccess",object,config).success(function(response){x.userDetails=undefined;x.userModules=[];x.message="";x.userRoles={};x.acctCustomers="";x.salesCustomers="";x.cssCustomers="";if(response[0]){x.userDetails=response[1];x.userModules=response[2];x.userRoles=response[3];x.acctCustomers=response[4];x.salesCustomers=response[5];x.cssCustomers=response[6];x.message="";x.warehouse=object.warehouse;x.availableWarehouse=object.warehouse}else{x.message=response[1]}storage.set("authorizationData",x);deferred.resolve(response)}).error(deferred.reject);return deferred.promise};var getUserWarehouse=function(payload){var deferred=$q.defer();$http.post(urlAPI+"/api/GetUserSlocs",payload,config).success(deferred.resolve).error(deferred.reject);return deferred.promise};var _logout=function(){storage.remove("authorizationData");x.userDetails=undefined;x.userModules=[];x.userRoles=[];x.message=""};var _fillAuthData=function(){var authData=storage.get("authorizationData");if(authData){x.userDetails=authData.userDetails;x.userModules=authData.userModules;x.userRoles=authData.userRoles;x.message=authData.message;x.warehouse=authData.warehouse}};authenticationFactory.fillAuthData=_fillAuthData;authenticationFactory.authData=x;authenticationFactory.login=create;authenticationFactory.logout=_logout;authenticationFactory.getUserWarehouse=getUserWarehouse;return authenticationFactory}]);"use strict";goApp.controller("MainController",["$scope","$timeout","MainService","$mdSidenav","$mdBottomSheet","$log","$q","AuthenticationFactory","$window","$mdDialog",MainController]);function MainController($scope,$timeout,mainService,$mdSidenav,$mdBottomSheet,$log,$q,af,$window,$mdDialog){var userId=1,userName="OSR Admin",userRole="OSR Admin";$scope.hasAccess=function(url){if((url=="main"||url=="main.home"||url=="main.dashboard"||url=="main.loadplan"||url=="main.warehouse_picking"||url=="main.checking_consolidation"||url=="main.loading_trucks"||url=="main.howto"||url=="main.chain"||url=="main.po_activity")&&userRole=="OSR Admin"){return true}else if((url=="main.dashboard"||url=="main.howto"||url=="main.po_activity")&&userRole=="OSR Sales"){return true}else if((url=="main.loadplan"||url=="main.howto")&&userRole=="OSR LoadPlan"){return true}else if((url=="main.warehouse_picking"||url=="main.howto")&&userRole=="OSR Picking"){return true}else if((url=="main.checking_consolidation"||url=="main.howto")&&userRole=="OSR Consolidation"){return true}else if((url=="main.loading_trucks"||url=="main.howto")&&userRole=="OSR Loading"){return true}else{return false}};var self=this;self.selected=null;self.main=[];self.selectMenu=selectMenu;self.toggleList=toggleMenusList;self.makeContact=makeContact;mainService.loadAllMenus().then(function(main){self.main=[].concat(main);self.selected=main[0]});function toggleMenusList(){$mdSidenav("left").toggle()}function selectMenu(main){$window.location.href=main.content;$window.location.reload(true)}function makeContact(selectedMenu){$mdBottomSheet.show({controllerAs:"cp",templateUrl:"assets/modules/menu/view/contactSheet.html",controller:["$mdBottomSheet",contactSheetController],
parent:angular.element(document.getElementById("content"))}).then(function(clickedItem){$log.debug(clickedItem.name+" clicked!")});function contactSheetController($mdBottomSheet){this.main=selectedMenu;this.actions=[{name:"MS Excel",icon:"phone",icon_url:"assets/svg/excel-icon.svg"}];this.contactMenu=function(action,name){$mdBottomSheet.hide(action)}}}$scope.toggleLeft=buildDelayedToggler("left");$scope.toggleRight=buildToggler("right");$scope.isOpenRight=function(){return $mdSidenav("right").isOpen()};function debounce(func,wait,context){var timer;return function debounced(){var context=$scope,args=Array.prototype.slice.call(arguments);$timeout.cancel(timer);timer=$timeout(function(){timer=undefined;func.apply(context,args)},wait||10)}}function buildDelayedToggler(navId){return debounce(function(){$mdSidenav(navId).toggle().then(function(){$log.debug("toggle "+navId+" is done")})},200)}function buildToggler(navId){return function(){$mdSidenav(navId).toggle().then(function(){$log.debug("toggle "+navId+" is done")})}}$scope.showAdvanced=function(ev){$mdDialog.show({controller:UserAccountController,templateUrl:"assets/modules/menu/view/user-account.html",parent:angular.element(document.body),targetEvent:ev,clickOutsideToClose:true}).then(function(answer){},function(){})};function UserAccountController($scope,$mdDialog){$scope.hide=function(){$mdDialog.hide()};$scope.cancel=function(){$mdDialog.cancel()};$scope.userName="OSR Admin",$scope.userRole="OSR Admin",$scope.warehouse="LP"}}goApp.controller("LeftCtrl",function($scope,$timeout,$mdSidenav,$log){$scope.close=function(){$mdSidenav("left").close().then(function(){$log.debug("close LEFT is done")})}});goApp.controller("RightCtrl",function($scope,$timeout,$mdSidenav,$log){$scope.close=function(){$mdSidenav("right").close().then(function(){$log.debug("close RIGHT is done")})}});goApp.controller("SpeedDial",function($scope){this.isOpen=false;this.selectedMode="md-fling";this.selectedDirection="up"});"use strict";goApp.service("MainService",["$q",MainService]);function MainService($q){var menu=[{name:"Home",avatar:"assets/svg/dripicons/home.svg",url:"main.home",content:"#/main/home"},{name:"Dashboard",avatar:"assets/svg/dripicons/graph-line.svg",url:"main.dashboard",content:"#/main/dashboard"},{name:"A: Preparation of LoadPlan",avatar:"assets/svg/dripicons/calendar.svg",url:"main.loadplan",content:"#/main/loadplan"},{name:"B: Start of Warehouse Picking",avatar:"assets/svg/dripicons/document-edit.svg",url:"main.warehouse_picking",content:"#/main/warehouse_picking"},{name:"C: Checking or Consolidation",avatar:"assets/svg/dripicons/document.svg",url:"main.checking_consolidation",content:"#/main/checking_consolidation"},{name:"D: Loading to Trucks",avatar:"assets/svg/dripicons/download.svg",url:"main.loading_trucks",content:"#/main/loading_trucks"},{name:"PO Activity",avatar:"assets/svg/dripicons/help.svg",url:"main.po_activity",content:"#/main/po_activity"},{name:"Chain Maintenance",avatar:"assets/svg/dripicons/link.svg",url:"main.chain",content:"#/main/chain"},{name:"How to Videos",avatar:"assets/svg/dripicons/question.svg",url:"main.howto",content:"#/main/howto"}];return{loadAllMenus:function(){return $q.when(menu)}}}"use strict";goApp.controller("PoActivityController",["$http","$mdEditDialog","$q","$timeout","$scope","$mdDialog","$mdMedia","PoActivityFactory","GlobalServices","AuthenticationFactory",PoActivityController]);function PoActivityController($http,$mdEditDialog,$q,$timeout,$scope,$mdDialog,$mdMedia,factory,globalServices,af){var ao=af.authData;var userRole=ao.userRoles[0].itemArray[1];if(userRole=="OSR Admin"||userRole=="OSR Sales"){}else{globalServices.youreNotAllowed()}$scope.loading=false;$scope.fd=globalServices.formatDate;$scope.fdt=globalServices.formatDateTime;$scope.getEarliestDate=function(){var args=Array.from(arguments);var orderedDates=args.sort(function(a,b){return Date.parse(a)>Date.parse(b)});if(orderedDates[0]!==null){return $scope.fdt(orderedDates[0])}};$scope.options={rowSelection:true,multiSelect:false,autoSelect:true,decapitate:false,largeEditDialog:false,boundaryLinks:false,limitSelect:true,pageSelect:true};$scope.selected=[];$scope.limitOptions=[5,8,10,15,20,50,100,500,1e3];$scope.query={order:"TruckAllocationNo",limit:8,page:1};$scope.logPagination=function(page,limit){console.log("page: ",page);console.log("limit: ",limit)};$scope.columns=[{name:"PONo",orderBy:"PONo"},{descendFirst:true,name:"SoldTo",numeric:true,orderBy:"SoldTo"}];$scope.records={};$scope.randMess="";var randomLoadingMessage=function(){var lines=new Array("Eating butter coconut...","Sipping noodles...","Practicing my Kungfu while eating mamon...","Generating records...","Brewing coffee...","Please be patient while getting data from the server...");$scope.randMess=lines[Math.round(Math.random()*(lines.length-1))];console.log($scope.randMess)};$scope.toggleLimitOptions=function(){$scope.limitOptions=$scope.limitOptions?undefined:[5,8,10,15,20,50,100,500,1e3]};$scope.onPaginate=function(page,limit){$scope.promise=$timeout(function(){},2e3)};$scope.deselect=function(item){};$scope.log=function(item){$scope.poDetails=item};var setToGlobalRecords=function(r){$scope.records.data=[].concat(r)};var setToLastQuery=function(query){$scope.lastQuery="";$scope.lastQuery=query};function getMonday(){var d=new Date;var day=d.getDay(),diff=d.getDate()-day+(day==0?-6:1);return globalServices.formatDate(d.setDate(diff))}function getSunday(){var d=new Date;var day=d.getDay(),diff=d.getDate()-day+(day==0?-6:1)+6;return globalServices.formatDate(d.setDate(diff))}var generateRecords=function(){randomLoadingMessage();$scope.loading=true;var payload={};payload.query="PO.RequiredDeliveryDate BETWEEN '"+getMonday()+"' AND '"+getSunday()+"' ";payload.topRow="2000";setToLastQuery("Required Delivery Date BETWEEN '"+getMonday()+"' AND '"+getSunday()+"' ");factory.getRecords(payload).then(function(r){setToGlobalRecords(r);$mdDialog.hide();$scope.loading=false},function(){console.log(payload.query);swal("Warning","An error encountered, please check your query combination.")})};$scope.loadStuff=function(){generateRecords()};$scope.loadStuff();$scope.onReorder=function(order){$scope.promise=$timeout(function(){},2e3)};$scope.showExportConfirm=function(ev){var confirm=$mdDialog.confirm().title("Would you like to export this to csv?").textContent("").ariaLabel("Export").targetEvent(ev).ok("Yes, please export!").cancel("Cancel");$mdDialog.show(confirm).then(function(){$scope.status="Confirmed";var mystyle={headers:true,column:{style:{Font:{Bold:"1"}}}};var sql="";sql+="SELECT";sql+=" warehouseCode AS Warehouse_Code";sql+=" , groupName AS Status";sql+=" , poNo AS PO_No";sql+=" , plateNo AS Plate_No";sql+=" , invoiceNo AS Invoice_No";sql+=" , requiredDeliveryDate AS Required_Delivery_Date";sql+=" , billingDate AS Invoice_Date";sql+=" , soldTo AS Customer_Code";sql+=" , customerName AS Customer_Name";sql+=" , soNo AS SO_No";sql+=" , doNo AS DO_No";sql+=" , orderDate AS Order_Date";sql+=" , orderType AS Order_Type";sql+=" , submittedToSAPDate AS CSS_Processing_Date_Time";sql+=" , loadPlanApprovalDateTime AS OSR_Loadplan_Date_Time";sql+=" , pickingDateTime AS OSR_Picking_Date_Time";sql+=" , consolidationDateTime AS OSR_Consolidation_Date_Time";sql+=" , loadingDateTime AS OSR_Loading_To_Truck_Date_Time";sql+=" , dateTimeTruckerArrived AS Trucker_Arrived_Date_Time";sql+=" , dateTimeTruckerDeparted AS Trucker_Departed_Date_Time";sql+=" , shipTo AS Ship_To";sql+=" , shipToAddress AS Ship_To_Address";sql+=" , shipToName AS Ship_To_Name";sql+=" , orderType AS OrderType";sql+=" , soNo AS SONo";sql+=" , doNo AS DONo";sql+=" , userName AS UserName";sql+=" , orderStatus AS OrderStatus";sql+=" , asmUserName AS AsmUserName";sql+=" , address AS Address";sql+=" , address1 AS Address1";sql+=" , address2 AS Address2";sql+=" , address3 AS Address3";sql+=" , city AS City";sql+=" , shipToContactNo AS ShipToContactNo";sql+=" , shipmentNo AS ShipmentNo";sql+=" , orderReason AS OrderReason";sql+=" , truckType AS TruckType";sql+=" , truckingCompany AS TruckingCompany";sql+=" , internalOrder AS InternalOrder";sql+=" , reprocessReason AS ReprocessReason";sql+=" , sapErrorMessage AS SAPErrorMessage";sql+=" , rejectedRemarks AS RejectedRemarks";sql+=" , accountingUserName AS AccountingUserName";sql+=" , loadPlanUserName AS LoadPlanUserName";sql+=" , loadPlanApprovalUserName AS LoadPlanApprovalUserName";sql+=" , pickingUserName AS PickingUserName";sql+=" , loadingUserName AS LoadingUserName";sql+=" , invoicingUserName AS InvoicingUserName";sql+=" , truckerArrivedSMSMobile AS TruckerArrivedSMSMobile";sql+=" , truckerArrivedSMSMessage AS TruckerArrivedSMSMessage";sql+=" , truckerDepartedSMSMobile AS TruckerDepartedSMSMobile";sql+=" , truckerDepartedSMSMessage AS TruckerDepartedSMSMessage";sql+=" , totalQtyOrdered AS TotalQtyOrdered";sql+=" , totalQtyAllocated AS TotalQtyAllocated";sql+=" , totalQtyUndelivered AS TotalQtyUndelivered";sql+=" , totalQtyServed AS TotalQtyServed";sql+=" , totalCBM AS TotalCBM";sql+=" , totalWeight AS TotalWeight";sql+=" , ofr AS OFR";sql+=" , area AS Area";sql+=" , chainCode AS ChainCode";sql+=" , chainName AS ChainName";sql+=" , statusDescription AS StatusDescription";sql+=" , consolidationUserName AS ConsolidationUserName";sql+=" , dateEncoded AS DateEncoded";sql+=" , dateUploaded AS DateUploaded";sql+=" , pricingDate AS PricingDate";sql+=" , weekNoDeliveryDate AS weekNoDeliveryDate";sql+=" , yearDeliveryDate AS YearDeliveryDate";sql+=" , weekNoOrderDate AS weekNoOrderDate";sql+=" , yearOrderDate AS YearOrderDate";sql+=" , weekNoDateEncoded AS weekNoDateEncoded";sql+=" , yearDateEncoded AS YearDateEncoded";sql+=" , weekNoDateUploaded AS weekNoDateUploaded";sql+=" , yearDateUploaded AS YearDateUploaded";sql+=" , weekNoSubmittedToSAPDate AS weekNoSubmittedToSAPDate";sql+=" , yearSubmittedToSAPDate AS YearSubmittedToSAPDate";sql+=" , rejectedDate AS RejectedDate";sql+=" , dateTimeAcctApproved AS DateTimeAcctApproved";sql+=" , dateTimeAcctDisapproved AS DateTimeAcctDisapproved";sql+=" , dateTimeAsmApproved AS DateTimeAsmApproved";sql+=" , dateTimeAsmDisapproved AS DateTimeAsmDisapproved";sql+=" , prsUserName AS PrsUserName";sql+=" , dateTimePrsApproved AS DateTimePrsApproved";sql+=" , dateTimePrsDisapproved AS DateTimePrsDisapproved";sql+=" , loadPlanDateTime AS LoadPlanDateTime";sql+=" , invoicingDateTime AS InvoicingDateTime";sql+=" , truckAllocationNo AS Truck_Allocation_No";sql+=" INTO CSV('POActivity_"+$scope.fdt(new Date)+".csv', {headers:true, separator:','}) FROM ?";alasql.promise(sql,[$scope.records.data]).then(function(result){console.log(result);if(result==1){swal("success","Your file is ready for download","success")}}).catch(function(err){swal("warning","The file is too large, an error occured!","warning")})},function(){$scope.status="Cancelled"})};$scope.showOrderDetails=function(ev,item){var useFullScreen=($mdMedia("sm")||$mdMedia("xs"))&&$scope.customFullscreen;function orderDetailsController($scope,$mdDialog){var payload={};payload.poId=item.poId;factory.getDetails(payload).then(function(result){$scope.poDetails=result});$scope.hide=function(){$mdDialog.hide()};$scope.cancel=function(){$mdDialog.cancel()}}$mdDialog.show({controllerAs:"odc",controller:["$scope","$mdDialog",orderDetailsController],templateUrl:"public/html/po-activity/view/order-details.html",parent:angular.element(document.body),targetEvent:ev,clickOutsideToClose:true,fullscreen:useFullScreen}).then(function(answer){$scope.status="You said the information was '"+answer+"'."},function(){$scope.status="You cancelled the dialog."});$scope.$watch(function(){return $mdMedia("xs")||$mdMedia("sm")},function(wantsFullScreen){$scope.customFullscreen=wantsFullScreen===true})};$scope.showMoreOptions=function(ev){$mdDialog.show({controllerAs:"odc",controller:["$scope","$mdDialog",moreOptionsController],templateUrl:"public/html/po-activity/view/more-options.html",parent:angular.element(document.body),targetEvent:ev,clickOutsideToClose:true}).then(function(answer){},function(){});function moreOptionsController($scope,$mdDialog){$scope.records={};$scope.records.data=[];$scope.hide=function(){$mdDialog.hide()};$scope.cancel=function(){$mdDialog.cancel()};$scope.loading=false;$scope.nextKey=1;$scope.items={0:{field:"PO.PONo LIKE '%",keyword:"",dateFrom:"",dateTo:"",condition:"",value:"PO No contains "}};$scope.remove=function(idx){delete $scope.items[idx]};$scope.delete=function(idx){var person_to_delete=$scope.persons[idx];API.DeletePerson({id:person_to_delete.id},function(success){$scope.persons.splice(idx,1)})};$scope.add=function(){$scope.items[$scope.nextKey]={field:"",keyword:"",dateFrom:"",dateTo:"",condition:" AND ",value:"",type:"String"};$scope.nextKey+=1;$scope.endClause=true};var resetQuery=function(){$scope.items={};$scope.items={0:{field:"PO.PONo LIKE '%",keyword:"",dateFrom:"",dateTo:"",condition:"",value:"PO No contains ",type:"String"}}};$scope.newQuery=function(){};$scope.resetQuery=function(){resetQuery()};$scope.condition=[{text:" AND ",value:"AND"},{text:" OR ",value:"OR"}];$scope.conditionIfDate=[{text:" AND ",value:"AND"},{text:" OR ",value:"OR"}];$scope.fields=[{text:"PO.WarehouseCode LIKE '%",value:"WarehouseCode",type:"String"},{text:"PO.GroupName LIKE '%",value:"GroupName",type:"String"},{text:"PO.PONo LIKE '%",value:"PONo",type:"String"},{text:"PO.PlateNo LIKE '%",value:"PlateNo",type:"String"},{text:"PO.InvoiceNo LIKE '%",value:"InvoiceNo",type:"String"},{text:"PO.RequiredDeliveryDate BETWEEN ",value:"RequiredDeliveryDate",type:"Date"},{text:"PO.BillingDate BETWEEN ",value:"BillingDate",type:"Date"},{text:"PO.SoldTo LIKE '%",value:"CustomerCode",type:"String"},{text:"PO.CustomerName LIKE '%",value:"CustomerName",type:"String"},{text:"PO.OrderDate BETWEEN ",value:"OrderDate",type:"Date"},{text:"PO.SubmittedToSAPDate BETWEEN ",value:"SubmittedToSAPDate",type:"Date"},{text:"PO.LoadPlanApprovalDateTime BETWEEN ",value:"LoadPlanApprovalDateTime",type:"Date"},{text:"PO.PickingDateTime BETWEEN ",value:"PickingDateTime",type:"Date"},{text:"PO.ConsolidationDateTime BETWEEN ",value:"ConsolidationDateTime",type:"Date"},{text:"PO.LoadingDateTime BETWEEN ",value:"LoadingDateTime",type:"Date"},{text:"PO.DateTimeTruckerArrived BETWEEN ",value:"DateTimeTruckerArrived",type:"Date"},{text:"PO.DateTimeTruckerDeparted BETWEEN ",value:"DateTimeTruckerDeparted",type:"Date"},{text:"PO.ShipTo LIKE '%",value:"ShipTo",type:"String"},{text:"PO.ShipToNameAddress LIKE '%",value:"ShipToNameAddress",type:"String"},{text:"PO.ShipToName LIKE '%",value:"ShipToName",type:"String"},{text:"PO.TruckAllocationNo LIKE '%",value:"TruckAllocationNo",type:"String"},{text:"PO.OrderType LIKE '%",value:"OrderType",type:"String"},{text:"PO.SONo LIKE '%",value:"SONo",type:"String"},{text:"PO.DONo LIKE '%",value:"DONo",type:"String"},{text:"PO.UserName LIKE '%",value:"CSSUserName LIKE '%",type:"String"},{text:"PO.AsmUserName LIKE '%",value:"AsmUserName",type:"String"},{text:"PO.Address LIKE '%",value:"Address",type:"String"},{text:"PO.InternalOrder LIKE '%",value:"InternalOrder",type:"String"},{text:"PO.AccountingUserName LIKE '%",value:"AccountingUserName",type:"String"},{text:"PO.LoadPlanUserName LIKE '%",value:"LoadPlanUserName",type:"String"},{text:"PO.Area LIKE '%",value:"Area",type:"String"},{text:"PO.ChainCode LIKE '%",value:"ChainCode",type:"String"},{text:"PO.ChainName LIKE '%",value:"ChainName",type:"String"},{text:"PO.StatusDescription LIKE '%",value:"StatusDescription",type:"String"}];$scope.endClause=true;$scope.changedCondition=function(item){if(item.condition!=="%' "){$scope.endClause=false}else{$scope.endClause=true}};$scope.changedField=function(item){switch(item.field){case"PO.WarehouseCode LIKE '%":item.value="WarehouseCode contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.GroupName LIKE '%":item.value="GroupName contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.PONo LIKE '%":item.value="PONo contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.PlateNo LIKE '%":item.value="PlateNo contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.InvoiceNo LIKE '%":item.value="InvoiceNo contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.RequiredDeliveryDate BETWEEN ":item.value="RequiredDeliveryDate contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="Date";break;case"PO.BillingDate BETWEEN ":item.value="BillingDate contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="Date";break;case"PO.SoldTo LIKE '%":item.value="SoldTo contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.CustomerName LIKE '%":item.value="CustomerName contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.OrderDate BETWEEN ":item.value="OrderDate contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="Date";break;case"PO.SubmittedToSAPDate BETWEEN ":item.value="SubmittedToSAPDate contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="Date";break;case"PO.LoadPlanApprovalDateTime BETWEEN ":item.value="LoadPlanApprovalDateTime contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="Date";break;case"PO.PickingDateTime BETWEEN ":item.value="PickingDateTime contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="Date";break;case"PO.ConsolidationDateTime BETWEEN ":item.value="ConsolidationDateTime contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="Date";break;case"PO.LoadingDateTime BETWEEN ":item.value="LoadingDateTime contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="Date";break;case"PO.DateTimeTruckerArrived BETWEEN ":item.value="DateTimeTruckerArrived contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="Date";break;case"PO.DateTimeTruckerDeparted BETWEEN ":item.value="DateTimeTruckerDeparted contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="Date";break;case"PO.ShipTo LIKE '%":item.value="ShipTo contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.ShipToNameAddress LIKE '%":item.value="ShipToNameAddress contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.ShipToName LIKE '%":item.value="ShipToName contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.TruckAllocationNo LIKE '%":item.value="TruckAllocationNo contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.OrderType LIKE '%":item.value="OrderType contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.SONo LIKE '%":item.value="SONo contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.DONo LIKE '%":item.value="DONo contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.UserName LIKE '%":item.value="CSSUserName LIKE '% contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.AsmUserName LIKE '%":item.value="AsmUserName contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.Address LIKE '%":item.value="Address contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.InternalOrder LIKE '%":item.value="InternalOrder contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.AccountingUserName LIKE '%":item.value="AccountingUserName contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.LoadPlanUserName LIKE '%":item.value="LoadPlanUserName contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.Area LIKE '%":item.value="Area contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.ChainCode LIKE '%":item.value="ChainCode contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.ChainName LIKE '%":item.value="ChainName contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;case"PO.StatusDescription LIKE '%":item.value="StatusDescription contains",item.keyword="",item.dateFrom="",item.dateTo="",item.type="String";break;default:item.value=""}};$scope.loadStuff=function(){randomLoadingMessage();$scope.loading=true;var payload={};var toString=[];var lastQuery=[];payload.query="";payload.topRow="2000";angular.forEach($scope.items,function(o){if(o.field==undefined||o.field==""){return false}if(o.dateFrom!==""){var dateF=moment(o.dateFrom);var dateT=moment(o.dateTo);if(dateF>=dateT){swal("Warning","Please provide a valid date range!","warning");return false}var currentKeyword="'"+globalServices.formatDate(o.dateFrom)+"'"+" AND "+"'"+globalServices.formatDate(o.dateTo)+"'";o.keyword=currentKeyword;toString.push(o.condition+" ");toString.push(o.field);toString.push(o.keyword);lastQuery.push(o.condition+" ");lastQuery.push(o.value);lastQuery.push(o.keyword)}else{toString.push(o.condition);toString.push(o.field);toString.push(o.keyword);toString.push("%' ");lastQuery.push(o.condition);lastQuery.push(o.value);lastQuery.push(" '"+o.keyword+"' ")}return false});payload.query=toString.join("");$scope.lastQuery=lastQuery.join("");factory.getRecords(payload).then(function(r){setToGlobalRecords(r);$mdDialog.hide();$scope.loading=false;setToLastQuery($scope.lastQuery)},function(){console.log(payload.query);swal("Warning","An error encountered, please check your query combination.")})}}}}"use strict";goApp.factory("PoActivityFactory",["$http","$q","APIService",function($http,$q,apiService){const urlApi=apiService.urlAPI;const f={};var u=urlApi+"/api/poactivity";var config={headers:{"Content-Type":"application/json; charset=utf-8"}};f.getRecords=function(payload){const d=$q.defer();$http.post(u,payload,config).success(d.resolve).error(d.reject);return d.promise};f.getDetails=function(payload){const d=$q.defer();$http.post(u+"/details",payload,config).success(d.resolve).error(d.reject);return d.promise};return f}]);"use strict";goApp.controller("UserController",["$http","$mdEditDialog","$q","$timeout","$scope","$mdDialog","UserService","GlobalServices",UserController]);function UserController($http,$mdEditDialog,$q,$timeout,$scope,$mdDialog,userService,globalServices){"use strict";$scope.options={rowSelection:true,multiSelect:true,autoSelect:true,decapitate:false,largeEditDialog:false,boundaryLinks:false,limitSelect:true,pageSelect:true};$scope.selected=[];$scope.limitOptions=[5,10,15];$scope.query={order:"name",limit:10,page:1};$scope.columns=[{name:"Dessert",orderBy:"name",unit:"100g serving"},{descendFirst:true,name:"Type",orderBy:"type"},{name:"Calories",numeric:true,orderBy:"calories.value"},{name:"Fat",numeric:true,orderBy:"fat.value",unit:"g"},{name:"Protein",numeric:true,orderBy:"protein.value",trim:true,unit:"g"},{name:"Iron",numeric:true,orderBy:"iron.value",unit:"%"},{name:"Comments",orderBy:"comment"}];userService.loadAllDesserts().then(function(result){$scope.desserts={};$scope.desserts.data=[].concat(result)});$scope.editComment=function(event,dessert){event.stopPropagation();var dialog={modelValue:dessert.comment,placeholder:"Add a comment",save:function(input){dessert.comment=input.$modelValue},targetEvent:event,title:"Add a comment",validators:{"md-maxlength":30}};var promise=$scope.options.largeEditDialog?$mdEditDialog.large(dialog):$mdEditDialog.small(dialog);promise.then(function(ctrl){var input=ctrl.getInput();input.$viewChangeListeners.push(function(){input.$setValidity("test",input.$modelValue!=="test")})})};$scope.toggleLimitOptions=function(){$scope.limitOptions=$scope.limitOptions?undefined:[5,10,15]};$scope.getTypes=function(){return["Candy","Ice cream","Other","Pastry"]};$scope.onPaginate=function(page,limit){console.log("Scope Page: "+$scope.query.page+" Scope Limit: "+$scope.query.limit);console.log("Page: "+page+" Limit: "+limit);$scope.promise=$timeout(function(){},2e3)};$scope.deselect=function(item){console.log(item.name,"was deselected")};$scope.log=function(item){console.log(item.name,"was selected")};$scope.loadStuff=function(){$scope.promise=$timeout(function(){},2e3)};$scope.onReorder=function(order){console.log("Scope Order: "+$scope.query.order);console.log("Order: "+order);$scope.promise=$timeout(function(){},2e3)};$scope.showExportConfirm=function(ev){var confirm=$mdDialog.confirm().title("Would you like to export this to excel?").textContent("You are about to export the data as excel file").ariaLabel("Export").targetEvent(ev).ok("Yes, please export!").cancel("Cancel");$mdDialog.show(confirm).then(function(){$scope.status="Confirmed";globalServices.exportExcel($scope.desserts.data,"DessertsTitle")},function(){$scope.status="Cancelled"})};$scope.showOrderDetails=function(ev){$mdDialog.show({controllerAs:"odc",controller:["$scope","$mdDialog",OrderDetailsController],templateUrl:"public/html/users/view/order-details.html",parent:angular.element(document.body),targetEvent:ev,clickOutsideToClose:true}).then(function(answer){$scope.status="You said the information was '"+answer+"'."},function(){$scope.status="You cancelled the dialog."});function OrderDetailsController($scope,$mdDialog){$scope.hide=function(){$mdDialog.hide()};$scope.cancel=function(){$mdDialog.cancel()};$scope.answer=function(answer){$mdDialog.hide(answer)}}};$scope.showMoreOptions=function(ev){$mdDialog.show({controllerAs:"odc",controller:["$scope","$mdDialog",MoreOptionsController],templateUrl:"public/html/users/view/more-options.html",parent:angular.element(document.body),targetEvent:ev,clickOutsideToClose:true}).then(function(answer){$scope.status="You said the information was '"+answer+"'."},function(){$scope.status="You cancelled the dialog."});function MoreOptionsController($scope,$mdDialog){}}}"use strict";goApp.service("UserService",["$q",UserService]);function UserService($q){var Dessert=[{name:"Frozen yogurt",type:"Ice cream",calories:{value:159},fat:{value:6},carbs:{value:24},protein:{value:4},sodium:{value:87},calcium:{value:14},iron:{value:1},comment:"Not as good as the real thing."},{name:"Ice cream sandwich",type:"Ice cream",calories:{value:237},fat:{value:9},carbs:{value:37},protein:{value:4.3},sodium:{value:129},calcium:{value:8},iron:{value:1}},{name:"Eclair",type:"Pastry",calories:{value:262},fat:{value:16},carbs:{value:24},protein:{value:6},sodium:{value:337},calcium:{value:6},iron:{value:7}},{name:"Cupcake",type:"Pastry",calories:{value:305},fat:{value:3.7},carbs:{value:67},protein:{value:4.3},sodium:{value:413},calcium:{value:3},iron:{value:8}},{name:"Jelly bean",type:"Candy",calories:{value:375},fat:{value:0},carbs:{value:94},protein:{value:0},sodium:{value:50},calcium:{value:0},iron:{value:0}},{name:"Lollipop",type:"Candy",calories:{value:392},fat:{value:.2},carbs:{value:98},protein:{value:0},sodium:{value:38},calcium:{value:0},iron:{value:2}},{name:"Honeycomb",type:"Other",calories:{value:408},fat:{value:3.2},carbs:{value:87},protein:{value:6.5},sodium:{value:562},calcium:{value:0},iron:{value:45}},{name:"Donut",type:"Pastry",calories:{value:452},fat:{value:25},carbs:{value:51},protein:{value:4.9},sodium:{value:326},calcium:{value:2},iron:{value:22}}];return{loadAllDesserts:function(){return $q.when(Dessert)}}}